<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exito</title>

  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" th:href="@{/img/logo.jpg}" type="image/jpg">
</head>

<body class="min-h-screen font-poppins bg-gradient-to-br from-[#0a1f44] via-[#0f2a5f] to-[#1b1f3b] text-white">

  <!-- NAVBAR -->
  <nav class="fixed top-0 w-full bg-[#020617]/70 backdrop-blur-xl border-b border-cyan-400/20 text-white shadow z-50">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex justify-between items-center h-16">
        <a th:href="@{/PaginaWeb/index}" class="text-xl font-bold text-cyan-400 tracking-wider">
          ðŸ’» TechNova
        </a>

        <button id="menuBtn" class="md:hidden text-2xl">â˜°</button>

        <ul id="menu" class="hidden md:flex gap-6 items-center">
          <li><a th:href="@{/PaginaWeb/index}" class="hover:text-cyan-400 transition">Inicio</a></li>
          <li><a th:href="@{/catalogo}" class="hover:text-cyan-400 transition">Productos</a></li>
          <li class="relative group">
            <span class="cursor-pointer hover:text-cyan-400 transition">CategorÃ­as</span>
            <ul class="absolute hidden group-hover:block bg-gray-800 mt-2 rounded shadow w-48">
              <li th:each="c : ${categorias}">
                <a th:href="@{'/catalogo?categoria=' + ${c.idCategoria}}"
                   th:text="${c.nombreCategoria}"
                   class="block px-4 py-2 hover:bg-red-500">
                </a>
              </li>
            </ul>
          </li>
          <li><a th:href="@{/nosotros}" class="hover:text-cyan-400 transition">Nosotros</a></li>
          <li><a th:href="@{/contacto}" class="hover:text-cyan-400 transition">Contacto</a></li>

          <li sec:authorize="!isAuthenticated()">
            <a th:href="@{/login}" class="bg-red-600 px-3 py-1 rounded">Login</a>
          </li>
          <li sec:authorize="!isAuthenticated()">
            <a th:href="@{/register}" class="border px-3 py-1 rounded">Registro</a>
          </li>

          <li sec:authorize="isAuthenticated()" class="flex items-center gap-4">
            <a th:href="@{/carrito}" class="relative hover:text-red-500 transition" title="Ver carrito">
              ðŸ›’
              <span th:if="${carritoCount > 0}" th:text="${carritoCount}" 
                    class="absolute -top-2 -right-3 bg-red-600 text-xs px-1.5 rounded-full"></span>
            </a>

            <div class="relative group">
              <span class="text-sm cursor-pointer hover:text-cyan-400 transition">
                Hola, <strong th:text="${nombreCom}"></strong> âŒ„
              </span>
              <ul class="absolute right-0 mt-2 w-40 bg-[#020617] border border-cyan-400/20 rounded-lg shadow-lg
                         opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                <li>
                  <a th:href="@{/perfil}" class="block px-4 py-2 hover:bg-cyan-600 hover:text-white rounded-lg">
                    ðŸ‘¤ Mi Perfil
                  </a>
                </li>
              </ul>
            </div>

            <a th:href="@{/logout}" class="border px-3 py-1 rounded hover:bg-red-600 transition">Salir</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- CONTENIDO PRINCIPAL -->
  <main class="max-w-5xl mx-auto mt-28 px-6">

    <!-- âœ… Compra Exitosa -->
    <div class="text-center mb-12">
      <div class="w-24 h-24 rounded-full border-4 border-green-400 flex items-center justify-center mx-auto animate-scale-up">
        <span class="text-green-400 text-5xl font-bold">âœ”</span>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold text-green-400 mt-4 mb-2">Â¡Compra exitosa!</h1>
      <p class="text-gray-300 text-lg">Tu pedido ha sido procesado correctamente.</p>
    </div>

    <!-- RESUMEN DEL PEDIDO -->
    <section class="bg-gray-800 rounded-lg p-6 mb-6 shadow-md">
      <h2 class="text-xl font-semibold mb-4">Resumen del pedido</h2>
      <p><strong>Pedido ID:</strong> <span th:text="${pedido.idPedido}"></span></p>
      <p><strong>Fecha:</strong> <span th:text="${#temporals.format(pedido.fechaPedido, 'dd/MM/yyyy HH:mm')}"></span></p>
      <p><strong>Estado:</strong> <span th:text="${pedido.estado}"></span></p>
      <p><strong>MÃ©todo de pago:</strong> <span th:text="${pedido.metodoPago}"></span></p>
      <p><strong>Total:</strong> S/ <span th:text="${pedido.total}"></span></p>
    </section>

    <!-- DETALLES DEL PEDIDO -->
    <section class="bg-gray-800 rounded-lg p-6 mb-6 shadow-md overflow-x-auto">
      <h2 class="text-xl font-semibold mb-4">Detalles del pedido</h2>
      <table class="w-full text-left table-auto border-collapse">
        <thead>
          <tr class="border-b border-gray-600">
            <th class="py-2 px-4">Producto</th>
            <th class="py-2 px-4">Cantidad</th>
            <th class="py-2 px-4">Precio Unitario</th>
            <th class="py-2 px-4">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="detalle : ${detalles}" class="border-b border-gray-700">
			<!-- Nombre + Imagen -->
			  <td class="py-2 px-4 flex items-center gap-4">
			    <div class="w-20 h-20 rounded-xl overflow-hidden flex-shrink-0 shadow-lg">
			      <img th:src="@{'/img/' + ${detalle.producto.imagen}}"
			           th:alt="${detalle.producto.nombre}"
			           class="w-full h-full object-contain hover:scale-105 transition">
			    </div>
			    <span th:text="${detalle.producto.nombre}"></span>
			  </td>
            <td class="py-2 px-4" th:text="${detalle.cantidad}"></td>
            <td class="py-2 px-4">S/ <span th:text="${detalle.precioUnitario}"></span></td>
            <td class="py-2 px-4">S/ <span th:text="${detalle.subtotal}"></span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- DATOS DE FACTURACIÃ“N -->
    <section class="bg-gray-800 rounded-lg p-6 mb-6 shadow-md">
      <h2 class="text-xl font-semibold mb-4">Datos de facturaciÃ³n</h2>
      <p><strong>Tipo documento:</strong> <span th:text="${comprobante.datosFacturacion.tipoDocumento}"></span></p>
      <p><strong>NÃºmero documento:</strong> <span th:text="${comprobante.datosFacturacion.numeroDocumento}"></span></p>
      <p><strong>Nombre / RazÃ³n Social:</strong> <span th:text="${comprobante.datosFacturacion.nombreRazonSocial}"></span></p>
      <p><strong>DirecciÃ³n:</strong> <span th:text="${comprobante.datosFacturacion.direccion}"></span></p>
      <p><strong>TelÃ©fono:</strong> <span th:text="${comprobante.datosFacturacion.telefono}"></span></p>
      <p><strong>Correo:</strong> <span th:text="${comprobante.datosFacturacion.correo}"></span></p>
    </section>

    <!-- COMPROBANTE -->
    <section class="bg-gray-800 rounded-lg p-6 mb-6 shadow-md">
      <h2 class="text-xl font-semibold mb-4">Comprobante</h2>
      <p><strong>Tipo:</strong> <span th:text="${comprobante.tipoComprobante}"></span></p>
      <p><strong>Serie:</strong> <span th:text="${comprobante.serie}"></span></p>
      <p><strong>NÃºmero:</strong> <span th:text="${comprobante.numero}"></span></p>
      <p><strong>Total:</strong> S/ <span th:text="${comprobante.total}"></span></p>
      <div class="mt-4">
		<a th:href="@{'/comprobante/descargar/' + ${comprobante.idComprobante}}"
		   class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded shadow transition">
		  Descargar PDF
		</a>
      </div>
    </section>

  </main>

  <!-- FOOTER -->
  <footer class="bg-[#020617]/80 backdrop-blur text-gray-300 border-t border-cyan-400/20 mt-12">
    <div class="container mx-auto px-6 py-12">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-10 text-center md:text-left">

        <!-- Logo / descripciÃ³n -->
        <div>
          <h2 class="text-2xl font-bold text-red-500 mb-3">ðŸ’» TechNova</h2>
          <p class="text-gray-400 text-sm">
            La mejor experiencia de tecnologÃ­a, con promociones y preventas exclusivas para nuestros clientes.
          </p>
        </div>

        <!-- Enlaces -->
        <div>
          <h3 class="font-semibold mb-3">Enlaces</h3>
          <ul class="space-y-2 list-none p-0 m-0">
            <li><a th:href="@{/PaginaWeb/index}" class="hover:text-red-500">Inicio</a></li>
            <li><a th:href="@{/cartelera}" class="hover:text-red-500">Productos</a></li>
            <li><a th:href="@{/nosotros}" class="hover:text-red-500">Nosotros</a></li>
            <li><a th:href="@{/contacto}" class="hover:text-red-500">Contacto</a></li>
          </ul>
        </div>

        <!-- Contacto -->
        <div>
          <h3 class="font-semibold mb-3">Contacto</h3>
          <p class="text-sm text-gray-400">Av. Wilson 123, Lima, PerÃº</p>
          <p class="text-sm text-gray-400">+51 987 654 321</p>
          <p class="text-sm text-gray-400">info@tecnologia.com</p>
        </div>

      </div>
      <hr class="my-8 border-gray-700">
      <p class="text-center text-gray-500 text-sm">Â© 2026 TechNova. Todos los derechos reservados.</p>
    </div>
  </footer>

  <!-- AnimaciÃ³n con Tailwind -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          animation: {
            'scale-up': 'scaleUp 0.5s ease forwards'
          },
          keyframes: {
            scaleUp: {
              '0%': { transform: 'scale(0)' },
              '100%': { transform: 'scale(1)' }
            }
          }
        }
      }
    }
  </script>
</body>
</html>
	