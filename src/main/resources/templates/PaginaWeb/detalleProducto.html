<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title th:text="${producto.nombre} + ' | TechNova'"></title>

  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" th:href="@{/css/PaginaWeb.css}">
  <link rel="icon" th:href="@{/img/logo.jpg}" type="image/jpg">

  <style>
    body { font-family: 'Poppins', sans-serif; }

    .descripcion {
      max-height: 5.5rem;
      overflow: hidden;
      transition: max-height .4s ease;
    }
    .descripcion.expanded {
      max-height: 500px;
    }
  </style>
</head>

<body class="min-h-screen text-white 
bg-gradient-to-br from-[#0a1f44] via-[#0f2a5f] to-[#1b1f3b]">

<!-- NAVBAR-->
	<nav class="fixed top-0 w-full 
	bg-[#020617]/70 backdrop-blur-xl
	border-b border-cyan-400/20 
	text-white shadow z-50">
	  <div class="max-w-7xl mx-auto px-6">
	    <div class="flex justify-between items-center h-16">

	      <!-- Logo -->
	      <a th:href="@{/PaginaWeb/index}" class="text-xl font-bold text-cyan-400 tracking-wider">
	        ðŸ’» TechNova
	      </a>

	      <!-- BotÃ³n mÃ³vil -->
	      <button id="menuBtn" class="md:hidden text-2xl">
	        â˜°
	      </button>

	      <!-- Links -->
	      <ul id="menu"
	          class="hidden md:flex gap-6 items-center">

	        <li><a th:href="@{/PaginaWeb/index}" class="hover:text-cyan-400 transition">Inicio</a></li>
	         <li><a th:href="@{/catalogo}" class="hover:text-cyan-400 transition">Productos</a></li>

	        <!-- Dropdown CategorÃ­as -->
	        <li class="relative group">
	          <span class="cursor-pointer hover:text-cyan-400 transition">CategorÃ­as</span>
	          <ul class="absolute hidden group-hover:block bg-gray-800 mt-2 rounded shadow w-48">
	            <li th:each="c : ${categorias}">
	             <a th:href="@{'/catalogo?categoria=' + ${c.idCategoria}}"
	                 th:text="${c.nombreCategoria}"
	                 class="block px-4 py-2 hover:bg-red-500">
	              </a>
	            </li>
	          </ul>
	        </li>
				
			<li><a th:href="@{/nosotros}" class="hover:text-cyan-400 transition">Nosotros</a></li>
			      <li><a th:href="@{/contacto}" class="hover:text-cyan-400 transition">Contacto</a></li>

			      <li sec:authorize="!isAuthenticated()">
			        <a th:href="@{/login}" class="bg-red-600 px-3 py-1 rounded">Login</a>
			      </li>
			      <li sec:authorize="!isAuthenticated()">
			        <a th:href="@{/register}" class="border px-3 py-1 rounded">Registro</a>
			      </li>
				  <li sec:authorize="isAuthenticated()" class="flex items-center gap-4">

				    <!-- ðŸ›’ CARRITO -->
				    <a th:href="@{/carrito}"
				       class="relative hover:text-red-500 transition"
				       title="Ver carrito">

				      ðŸ›’
				      <!-- contador  -->
					  <span th:if="${carritoCount > 0}"
					        th:text="${carritoCount}"
					        class="absolute -top-2 -right-3 
					               bg-red-600 text-xs px-1.5 
					               rounded-full">
					  </span>

				    <!-- ðŸ‘¤ USUARIO -->
					<div class="relative group">

										  <!-- Texto principal -->
										  <span class="text-sm cursor-pointer hover:text-cyan-400 transition">
										    Hola, <strong th:text="${nombreCom}"></strong> âŒ„
										  </span>

										  <!-- Dropdown -->
										  <ul class="absolute right-0 mt-2 w-40
										         bg-[#020617] border border-cyan-400/20
										         rounded-lg shadow-lg
										         opacity-0 invisible
										         group-hover:opacity-100 group-hover:visible
										         transition-all duration-200 ease-in-out">

										    <li>
										      <a th:href="@{/perfil}"
										         class="block px-4 py-2 hover:bg-cyan-600 hover:text-white rounded-lg">
										        ðŸ‘¤ Mi Perfil
										      </a>
										    </li>

										  </ul>

										</div>


				  </li>

				  <li sec:authorize="isAuthenticated()">
				    <a th:href="@{/logout}"
				       class="border px-3 py-1 rounded hover:bg-red-600 transition">
				      Salir
				    </a>
				  </li>
			    </ul>
			  </div>
			</nav>

<!-- DETALLE PRODUCTO -->
<section class="pt-28 pb-20 px-6">
  <div class="max-w-6xl mx-auto 
              bg-white/5 backdrop-blur-xl 
              rounded-2xl shadow-2xl 
              border border-white/10 p-8">

    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
		<!-- Imagen -->
		<div class="rounded-xl overflow-hidden shadow-lg 
		            flex items-center justify-center">
		  <img th:src="@{'/img/' + ${producto.imagen}}"
		       th:alt="${producto.nombre}"
		       class="max-h-[500px] object-contain hover:scale-105 transition">
		</div>

      <!-- Info -->
      <div>
        <h1 class="text-3xl font-bold mb-3" th:text="${producto.nombre}"></h1>

        <!-- CategorÃ­a -->
		<span class="inline-block mb-4 px-3 py-1 text-sm rounded-full 
		             bg-cyan-400/20 text-cyan-300">
		    <span th:text="${categoriaNombre}"></span>
		</span>
		
        <!-- DescripciÃ³n -->
        <p id="descripcion" class="descripcion text-gray-300 mb-2"
           th:text="${producto.descripcion}"></p>

        <span id="toggleLeerMas"
              class="text-cyan-400 cursor-pointer font-semibold">
          Leer mÃ¡s
        </span>
		
		<!-- ESPECIFICACIONES-->
		<div class="mt-6"
		     th:if="${#maps.size(especificaciones) > 0}">

		  <h3 class="text-lg font-semibold text-cyan-400 mb-3">
		    ðŸ“‹ Especificaciones TÃ©cnicas
		  </h3>

		  <div class="bg-white/5 border border-cyan-400/20 
		              rounded-xl p-4 space-y-3">

		    <div class="flex justify-between border-b border-white/10 pb-2"
		         th:each="entry : ${especificaciones}">

		      <span class="text-gray-400"
		            th:text="${entry.key}"></span>

		      <span class="font-semibold text-white"
		            th:text="${entry.value}"></span>

		    </div>

		  </div>
		</div>
		<!-- Precio -->
		<div class="mt-6">
		    <p class="text-sm text-gray-400">Precio</p>

		    <!-- Si hay descuento -->
		    <div th:if="${descuento}">
		        
		        <!-- Precio original tachado -->
		        <p class="text-xl text-gray-400 line-through"
		           th:text="'S/. ' + ${#numbers.formatDecimal(producto.precio,1,2)}">
		        </p>

		        <!-- Precio con descuento resaltado -->
		        <p class="text-3xl font-extrabold text-green-400"
		           th:text="'S/. ' + ${#numbers.formatDecimal(descuento,1,2)}">
		        </p>
		    </div>

		    <!-- Si NO hay descuento -->
		    <div th:unless="${descuento}">
		        <p class="text-3xl font-extrabold text-green-400"
		           th:text="'S/. ' + ${#numbers.formatDecimal(producto.precio,1,2)}">
		        </p>
		    </div>
		</div>

		
		

        <!-- Stock -->
        <div class="mt-4">
          <span class="text-sm text-gray-400">Stock:</span>
          <span class="font-semibold"
                th:text="${producto.stock}"
                th:classappend="${producto.stock > 0} ? 'text-green-400' : 'text-red-500'">
          </span>
        </div>
		
		<input type="number"
		       name="cantidad"
		       min="1"
		       th:max="${producto.stock}"
		       value="1"
		       class="w-20 text-black rounded px-2">

			   <!-- Acciones -->
			   <div class="mt-8 flex gap-4">

			       <!-- Formulario para agregar al carrito -->
			       <form th:action="@{'/carrito/agregar/' + ${producto.idProducto}}" method="post">
			           <button type="submit"
			               class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-xl font-semibold transition">
			               Agregar al carrito
			           </button>
			       </form>

			       <!-- Volver al inicio -->
			       <a th:href="@{/PaginaWeb/index}"
			          class="border border-white/30 px-6 py-3 rounded-xl hover:bg-white/10 transition">
			           Volver
			       </a>

			   </div>
      </div>
    </div>
  </div>
</section>


<!-- LEER MÃS -->
<script>
  const descripcion = document.getElementById('descripcion');
  const toggleBtn = document.getElementById('toggleLeerMas');

  toggleBtn.addEventListener('click', () => {
    descripcion.classList.toggle('expanded');
    toggleBtn.textContent =
      descripcion.classList.contains('expanded')
        ? 'Leer menos'
        : 'Leer mÃ¡s';
  });
</script>
<!-- âš« FOOTER -->
<footer class="bg-[#020617]/80 backdrop-blur 
text-gray-300 border-t border-cyan-400/20">

  <div class="container mx-auto px-6 py-12">

    <div class="grid grid-cols-1 md:grid-cols-4 gap-10 text-center md:text-left">

      <!-- Logo / descripciÃ³n -->
      <div>
        <h2 class="text-2xl font-bold text-red-500 mb-3"> ðŸ’» TechNova</h2>
        <p class="text-gray-400 text-sm">
          La mejor experiencia de tecnologia, con promociones, descuentos y preventas exclusivas para nuestros clientes.
        </p>
      </div>

      <!-- Enlaces -->
      <div>
        <h3 class="font-semibold mb-3">Enlaces</h3>
        <ul class="space-y-2 list-none p-0 m-0">
          <li><a th:href="@{/PaginaWeb/index}" class="hover:text-red-500">Inicio</a></li>
          <li><a th:href="@{/cartelera}" class="hover:text-red-500">Productos</a></li>
          <li><a th:href="@{/nosotros}" class="hover:text-red-500">Nosotros</a></li>
          <li><a th:href="@{/contacto}" class="hover:text-red-500">Contacto</a></li>
        </ul>
      </div>


      <!-- Contacto -->
      <div>
        <h3 class="font-semibold mb-3">Contacto</h3>
        <p class="text-sm text-gray-400">
          <i class="bi bi-geo-alt-fill me-1"></i> Av. Wilson 123, Lima, PerÃº
        </p>
        <p class="text-sm text-gray-400">
          <i class="bi bi-telephone-fill me-1"></i> +51 987 654 321
        </p>
        <p class="text-sm text-gray-400">
          <i class="bi bi-envelope-fill me-1"></i> info@tecnologia.com
        </p>
      </div>

    </div>

    <hr class="my-8 border-gray-700">

    <p class="text-center text-gray-500 text-sm">
      Â© 2026 TechNova. Todos los derechos reservados.
    </p>
  </div>
</footer>
</body>
</html>
